---
import { ModeToggle } from "@/components/ModeToggle";
import "../styles/global.css";
import { MainTabs } from "@/components/MainTabs";
import GitHub from "@/components/icons/GitHub.astro";
import Twitter from "@/components/icons/Twitter.astro";
import LinkedIn from "@/components/icons/LinkedIn.astro";
import Cal from "@/components/icons/Cal.astro";
import { HoverPic } from "@/components/HoverPic";
import { cn } from "@/lib/utils";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>Dominik Koch - Software Engineer</title>
    <style>
      .precise-age {
        font-family: monospace;
        display: inline-block;
        min-width: 12ch;
      }
      h1 {
        font-family: "Gambarino", serif;
      }
      .grid-bg {
        will-change: mask-image;
        --mouse-x: 50%;
        --mouse-y: 50%;
      }
    </style>
  </head>

  <body>
    <div
      class="relative min-h-screen w-full bg-white dark:bg-black overflow-hidden"
    >
      <div
        class={cn(
          "fixed inset-0 grid-bg",
          "[background-size:20px_20px]",
          "[background-image:radial-gradient(#d4d4d4_1px,transparent_1px)]",
          "dark:[background-image:radial-gradient(#404040_1px,transparent_1px)]"
        )}
        style="mask-image: radial-gradient(circle 200px at var(--mouse-x) var(--mouse-y), transparent 0%, transparent 30%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.8) 100%), radial-gradient(circle 400px at var(--mouse-x) var(--mouse-y), rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.9) 100%)"
      >
      </div>
      <div
        class={cn(
          "fixed inset-0 pointer-events-none",
          "[background-size:20px_20px]",
          "[background-image:radial-gradient(#3b82f6_1px,transparent_1px)]",
          "dark:[background-image:radial-gradient(#60a5fa_1px,transparent_1px)]"
        )}
        style="mask-image: radial-gradient(circle 200px at var(--mouse-x) var(--mouse-y), black 0%, rgba(0,0,0,0.8) 40%, rgba(0,0,0,0.2) 70%, transparent 100%)"
      >
      </div>
      <div
        class="pointer-events-none fixed inset-0 bg-white [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black)] dark:bg-black"
      >
      </div>

      <main
        class="text-zinc-900 dark:text-zinc-100 max-w-xl mx-auto px-4 py-4 mt-16 relative z-10"
      >
        <section class="flex flex-col gap-4 mb-8">
          <div class="flex items-center justify-between">
            <HoverPic client:load>
              <h1 class="text-2xl font-medium tracking-tight">
                Hi, I'm Dominik Koch
              </h1>
            </HoverPic>
            <ModeToggle client:load />
          </div>
          <p class="text-md">
            Software Engineer based in Germany, <span
              id="age"
              class="precise-age">ü§®</span
            > years old with a passion for open source. Self proclaimed <span
              >10x engineer</span
            > currently working on <a
              href="https://rivo.gg/"
              target="_blank"
              class="font-bold relative after:absolute after:bg-zinc-900 dark:after:bg-zinc-100 after:bottom-0 after:left-0 after:h-[2px] after:w-full after:origin-left after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:duration-300 after:ease-in-out">Rivo</a
            > and <a
              href="https://wouldyoubot.gg/"
              target="_blank"
              class="font-bold relative after:absolute after:bg-zinc-900 dark:after:bg-zinc-100 after:bottom-0 after:left-0 after:h-[2px] after:w-full after:origin-left after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:duration-300 after:ease-in-out">Would You Bot</a
            >.
          </p>
          <div class="flex flex-row gap-4">
            <a
              href="https://cal.com/dominikkoch"
              target="_blank"
              class="overflow-hidden transition-all text-zinc-900/60 dark:text-zinc-100/60 hover:text-zinc-900/100 dark:hover:text-zinc-100/100"
            >
              <p class="sr-only">Cal.com</p>
              <Cal class="h-5 w-5 transition-all" />
            </a>
            <a
              href="https://github.com/mezotv"
              target="_blank"
              class="overflow-hidden transition-all text-zinc-900/60 dark:text-zinc-100/60 hover:text-zinc-900/100 dark:hover:text-zinc-100/100"
            >
              <p class="sr-only">GitHub</p>
              <GitHub class="h-5 w-5 transition-all" />
            </a>
            <a
              href="https://twitter.com/dominikdoesdev"
              target="_blank"
              class="overflow-hidden transition-all text-zinc-900/60 dark:text-zinc-100/60 hover:text-zinc-900/100 dark:hover:text-zinc-100/100"
            >
              <p class="sr-only">Twitter</p>
              <Twitter class="h-5 w-5 transition-all" />
            </a>
            <a
              href="https://linkedin.com/in/dominikkoch"
              target="_blank"
              class="overflow-hidden transition-all text-zinc-900/60 dark:text-zinc-100/60 hover:text-zinc-900/100 dark:hover:text-zinc-100/100"
            >
              <p class="sr-only">LinkedIn</p>
              <LinkedIn class="h-5 w-5 transition-all" />
            </a>
          </div>
        </section>
        <MainTabs client:load />
      </main>
      <footer class="fixed bottom-0 left-0 right-0">
        <div class="flex items-center justify-between max-w-xl mx-auto px-4 py-4">
          <p class="text-muted-foreground">
            Made with <span class="text-red-500">‚ù§Ô∏è</span> by Dominik Koch
          </p>
          <p class="text-muted-foreground">
            Inspired by <a
              href="https://ahmet.studio/"
              target="_blank"
              class="overflow-hidden transition-all text-muted-foreground hover:text-foreground"
            >Ahmet Kilinc</a>!
          </p>
        </div>
      </footer>
    </div>

    <script is:inline>
      const getThemePreference = () => {
        if (
          typeof localStorage !== "undefined" &&
          localStorage.getItem("theme")
        ) {
          return localStorage.getItem("theme");
        }
        return window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "light";
      };
      const isDark = getThemePreference() === "dark";
      document.documentElement.classList[isDark ? "add" : "remove"]("dark");

      if (typeof localStorage !== "undefined") {
        const observer = new MutationObserver(() => {
          const isDark = document.documentElement.classList.contains("dark");
          localStorage.setItem("theme", isDark ? "dark" : "light");
        });
        observer.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ["class"],
        });
      }

      // Mouse cursor effect for grid background
      let mouseX = 0;
      let mouseY = 0;
      let targetX = 0;
      let targetY = 0;
      
      function updateMousePosition(e) {
        targetX = (e.clientX / window.innerWidth) * 100;
        targetY = (e.clientY / window.innerHeight) * 100;
      }
      
      function animateGrid() {
        mouseX += (targetX - mouseX) * 0.1;
        mouseY += (targetY - mouseY) * 0.1;
        
        const gridBgs = document.querySelectorAll('.grid-bg, .grid-bg + div');
        gridBgs.forEach(bg => {
          bg.style.setProperty('--mouse-x', `${mouseX}%`);
          bg.style.setProperty('--mouse-y', `${mouseY}%`);
        });
        
        requestAnimationFrame(animateGrid);
      }
      
      window.addEventListener('mousemove', updateMousePosition);
      animateGrid();
    </script>

    <script>
      function updateAge() {
        const birthday = new Date("2005-01-17T00:00:00+01:00").getTime(); // German timezone (CET)
        const now = performance.now() + performance.timeOrigin;
        const ageInMs = now - birthday;
        const ageInYears = ageInMs / (1000 * 60 * 60 * 24 * 365.25);
        const ageElement = document.getElementById("age");
        if (ageElement) {
          ageElement.textContent = ageInYears.toFixed(11);
        }
        requestAnimationFrame(updateAge);
      }
      updateAge();
    </script>
  </body>
</html>
